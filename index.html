<!DOCTYPE html>
<html lang="en">
<head>


  
<script>
// if(window.location.href != 'https://c-orta.github.io/?key=key&value=value'){
// window.location.replace('https://c-orta.github.io/?key=key&value=value');
// }


// setTimeout(()=> {
//   window.location.replace('?key=key&value=value');
// }, "1000");
  
console.log('starting here')
const url = new URL(window.location);
url.searchParams.set('key','key');
url.searchParams.set('value','value');
window.history.pushState({},'',url)
console.log('ending here')

</script>



<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P42CPVX8');</script>
<!-- End Google Tag Manager -->




<script>
  //Part 2 Code
  
  // using notation from https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch for API call

function testAPI(){
  async function runAPICall(){
    console.log('Running testAPI function');
    const url = 'https://httpbin.org/get';
    try{
      const response = await fetch(url);
      if (!response.ok){
        throw new Error('Response status: ${response.status}');
      }
    
    const responseJSON = await response.json();
    console.log('This is the JSON:');
    console.log(responseJSON);
    console.log('End of JSON');
    } catch (error){
      console.error(error.message)
    }
  }
  runAPICall();
  console.log('Done with testAPI function');
}
  
</script>



<script>
  window.dataLayer = window.dataLayer || [];
  dataLayer.push({'key':'key',
                  'value':'value'
              });
  console.log('pushed dataLayer data');
</script>

</head>


<body>
  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P42CPVX8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



<h3>
This is for my assessment.
</h3>

<h4>
This is for part 1: <br>
</h4>

<h5> 
1. Implement Google Tag Manager on your website site. <br>
2. Load your website with the following query string parameter: ?key=key&value=value  E.g. https://mysite.com?key=key&value=value
<br>
3. Add functionality to push the key and value to the GTM data layer.
<br>

------------------------------------------------------------------------------------------------------------------ <br>



1. Done <br>
2. Done <br>
3. Done <br>


------------------------------------------------------------------------------------------------------------------ <br>
</h5>
  
<h4>API Implementation </h4> <br>

<h5>
1. Add a button to your page that sends a GET API request using http://httpbin.org/ <br>

2. The API call should use the query string parameters stored in the GTM data layer (from task 1) as key-value pairs sent to the GET request.  E.g. https://httpbin.org/get?key=key&value=value <br>

3. Log the response in the console. <br>

------------------------------------------------------------------------------------------------------------------ <br>

1. In Progress <br>
2. Not yet <br>
3. Not yet <br>

------------------------------------------------------------------------------------------------------------------ <br>

</h5>

<button type='button' onclick='testAPI()'> CLICK HERE for 2.1  </button>
</body>
